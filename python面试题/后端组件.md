[TOC]



# mysql

## mysql的数据结构

## 数据库的调优

### 配置的优化

### 查询语句的优化

### 软件代码层次的优化

+ explain()方法了解queryset的细节
+ 使用索引，对经常查询的字段加上索引
+ 计算上移，计算相关尽量上移到应用层，如：少用order_by()，不推荐使用存储过程，的hi有QuerySet的count()和exists()会更快。
+ 使用缓存，mysql默认开启查询缓存，而curdate，now，rand等不会使用缓存
+ 选择较好的存储引擎。一般使用innoDB
+ 获取想要的数据。使用QuerySet中的values()和values_list()方法指定想要查询的字段
+ 设计ID字段
+ 批量操作，操作多个对象时，使用bulk_create()方法，这会减少sql查询的数量
+ 使用utf8mb4编码
+ 尽可能一次性获取想要的数据，使用select_related()和prefetch_related()

## 数据库策略

### 乐观锁

### 悲观锁

### 冲突主动解决

## 拓展

### 纵向拓展，横向拓展

+ 纵向：增强单个数据服务能力：增加cpu，增加内存，增加存储空间，使用更加强大服务器
+ 横向，使用多个数据库服务组合起来，技术要求较高

#### 读写分离

+ 主从复制时单向的从主机到从机，至少需要定义两个数据源，一个用于写，一个用于读。
+ binlog日志，binlog日志传入从机告知从机有新的binlog写入。
+ 从机->两个线程处理复制，
  + I/O线程连接主服务器读取二进制日志事件，复制到本地日志文件中（中继日志），
  + sql线程，从中继日志中读取事件，并在本地中执行。
+ 在django中的实现：
  + 配置多个数据库
  + 实现DefaultRouter类，定义db_for_read,db_for_write
  + setting中添加数据库路由DATABASE_ROUTRS
  + 多个从机实现读的负载均衡
    + 创建DNS记录，（内网DNS）
    + 策略：随机选择
  + using关键字指定使用的数据库

#### 垂直分库

大型数据，分库分表才有意义

# redis

## redis的数据结构

### 每种数据类型的应用案例

+ 集合
+ 有序集合

## 设置定时任务

## 持久化策略

# rabbitmq

## 六种模式

# docker

## dockerfile文件编写

## 多容器部署

# linux

## 管理命令

## 用户权限命令

## shell脚本编写

